# Implementation Plan: Fix Role Field in Registration Form

**Branch**: `2-fix-role-field` | **Date**: 2026-01-27 | **Spec**: [spec.md](./spec.md)
**Input**: Feature specification from `/specs/2-fix-role-field/spec.md`

**Note**: This plan was generated by the `/speckit.plan` command for the role field validation and persistence feature.

## Summary

Enhance the role selection dropdown in the Vue 3 registration form to ensure proper validation, display user-friendly descriptions for each role option (Student/Instructor), and maintain the selected value when validation errors occur in other form fields. The feature leverages the existing FormSelect component with proper error handling and form state management through Pinia store integration.

## Technical Context

**Language/Version**: PHP 8.2 (backend) + JavaScript/Vue 3.5 (frontend)
**Primary Dependencies**: Laravel 12.47, Vue 3.5, Vite 7, Tailwind CSS 4, Axios 1.11, Pinia 2.2
**Storage**: SQLite (development), supports PostgreSQL/MySQL in production
**Testing**: Vitest 1.0 (frontend), PHPUnit 11.5 (backend)
**Target Platform**: Web application (SPA with Laravel backend)
**Project Type**: Web application (frontend: Vue SPA, backend: Laravel API)
**Performance Goals**: Form validation response <500ms, form submission <3s, role validation instant on field change
**Constraints**: Must work on all modern browsers (Chrome, Firefox, Safari, Edge 2020+), minimal JavaScript bundle impact, WCAG 2.1 AA accessibility
**Scale/Scope**: Single form feature with 2 role options, 1 component enhancement, ~200 LOC changes

## Constitution Check

*GATE: Must pass before Phase 0 research. Re-check after Phase 1 design.*

**Status**: ✅ PASS

No project constitution file exists yet. This is a small, focused feature within an existing Laravel+Vue application. No architecture violations or framework violations detected. Feature scope is appropriately bounded to a single form component enhancement.

## Project Structure

### Documentation (this feature)

```text
specs/2-fix-role-field/
├── plan.md              # This file (implementation plan)
├── research.md          # Phase 0 output (research findings)
├── data-model.md        # Phase 1 output (data structure design)
├── quickstart.md        # Phase 1 output (developer quick reference)
├── contracts/           # Phase 1 output (API/component contracts)
│   ├── components.md    # FormSelect component contract
│   └── api.md          # Registration API contract
├── checklists/
│   └── requirements.md  # Quality validation checklist
└── tasks.md             # Phase 2 output (implementation tasks)
```

### Source Code Layout (Web Application)

```text
# Frontend (Vue 3 SPA)
resources/js/
├── components/auth/
│   ├── FormSelect.vue            # Role dropdown component (enhanced)
│   ├── AuthCard.vue              # Form wrapper
│   ├── FormField.vue             # Text input wrapper
│   └── SubmitButton.vue          # Submit button wrapper
├── pages/auth/
│   └── Register.vue              # Registration page (enhanced)
├── composables/
│   ├── useAuth.js               # Auth state (existing)
│   ├── useFormValidation.js     # Form validation (existing)
│   └── useFormPersistence.js    # Form state persistence (NEW)
├── stores/                       # Pinia stores
│   └── auth.js                  # Auth state management (may enhance)
└── router/
    └── index.js                 # Route configuration

# Tests
tests/unit/
├── components/
│   └── FormSelect.spec.js       # Component tests
└── composables/
    └── useFormValidation.spec.js # Validation tests

# Backend (Laravel API)
app/Http/Controllers/Auth/
└── RegisterController.php        # Existing registration controller
```

**Structure Decision**: Web application architecture with separated frontend (Vue 3 SPA in resources/js) and backend (Laravel API). Role field enhancement is a frontend component change with potential backend validation enhancements. No new models or controllers required—existing registration infrastructure is sufficient.

## Phase 0: Research & Analysis

**Status**: Complete ✅

### Key Findings

1. **FormSelect Component**: Existing component supports all required props (modelValue, error, required, disabled, options, placeholder)
2. **Form State Management**: Pinia store exists for auth state; form fields persist via reactive refs in component
3. **Validation Pattern**: Established pattern in Register.vue using inline validators and errors ref
4. **Role Data**: Two hardcoded options (Student/Instructor) with descriptions already in Register.vue
5. **Error Handling**: ErrorMessage and SuccessMessage components available for UX feedback

### No Unknowns Remaining

All technical aspects are clear:
- Form component architecture is established and working
- Validation pattern is consistent
- Backend registration API already accepts role field
- No new dependencies required

### Design Decisions

- **No new composables**: Reuse existing useFormValidation pattern
- **No state library changes**: Form state remains in component (reactive refs)
- **No API changes**: Existing registration endpoint already handles role
- **Component-only change**: Enhancement isolated to FormSelect wrapper and Register.vue validation

## Phase 1: Design & Contracts

**Status**: Complete ✅

### Design Outputs Generated

- **data-model.md**: Registration form data structure and validation rules
- **contracts/components.md**: FormSelect component API contract (unchanged, fully compliant)
- **contracts/api.md**: Registration API contract documentation
- **quickstart.md**: Developer guide for testing and implementation
